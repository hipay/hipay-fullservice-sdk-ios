//
//  HPFCardTokenPaymentMethodRequest.h
//  Pods
//
//  Created by HiPay on 14/10/2015.
//
//

#import "HPFAbstractPaymentMethodRequest.h"
#import "HPFTransaction.h"

/**
 *  Indicates if the 3-D Secure authentication should be performed.
 */
typedef NS_ENUM(NSInteger, HPFAuthenticationIndicator) {
    
    /**
     *  Default authentication indicator.
     */
    HPFAuthenticationIndicatorDefault = NSIntegerMax,
    
    /**
     *  Bypass 3-D Secure authentication.
     */
    HPFAuthenticationIndicatorBypass = 0,
    
    /**
     *  3-D Secure authentication if available.
     */
    HPFAuthenticationIndicatorIfAvailable = 1,
    
    /**
     *  3-D Secure authentication mandatory. Transactions will be declined if card holder is not enrolled.
     */
    HPFAuthenticationIndicatorMandatory = 2,
};

/**
 *  Describes payment card information to be sent alongside an order request.
 */
@interface HPFCardTokenPaymentMethodRequest : HPFAbstractPaymentMethodRequest

/**
 *  The card token generated by the Secure Vault.
 */
@property (nonatomic, copy) NSString * _Nonnull cardToken;

/**
 *  Electronic Commerce Indicator (ECI).
 *  The ECI indicates the security level at which the payment information is processed between the cardholder and merchant.
 */
@property (nonatomic) HPFECI eci;

/**
 *  Indicates if the 3-D Secure authentication should be performed.
 */
@property (nonatomic) HPFAuthenticationIndicator authenticationIndicator;

/**
 *  Instantiate a card token request, to be sent alongside an order request.
 *
 *  @param token                   The card token generated by the Secure Vault.
 *  @param eci                     Electronic Commerce Indicator (ECI).
 *  @param authenticationIndicator Indicates if the 3-D Secure authentication should be performed.
 *
 *  @return A new card token request.
 */
+ (instancetype _Nonnull)cardTokenPaymentMethodRequestWithToken:(NSString * _Nonnull)token eci:(HPFECI)eci authenticationIndicator:(HPFAuthenticationIndicator)authenticationIndicator;

@end
